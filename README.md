# Opt_for_NNetwork
 code and data for optimization results, with model biological neuronal network

Here are the steps for generating the model data, using DA, and reading DA output.

###
1) Generate the model data.  (GenerativeModel...ipynb, injected currents, and resulting data to read into the DA procedure)

The three-neuron model is integrated forward via the Jupyter Notebook script "GenerativeModel...ipynb".  This script takes in 
three injected currents, one for each neuron: "injnew1_wStepsHigh2.txt", "injnew2_wStepsHigh2.txt", and "injnew3_wStepsHigh2.txt". 
It generates time series of all state variables of the model.  Six of those variables (out of the 27 total) are saved: time series of 
membrane voltage and calcium concentration for each of the three cells.

To generate the data used in the DA procedure, choose one of two sets of synaptic strengths: "quiescence" or "active WLC" - which are 
specified at the beginning of the script (and de-activate the set that you don't want to use).

The data described in the paper are the three membrane voltage traces (the time series of Ca concentration are also mentioned but not 
discussed in detail).  

In this folder you will find the three membrane voltage traces generated from the "quiescence" synapse strengths:
  V0_NaKLCaT_chaotic_Q_dt0.1_T800.0_18aug14_NOISY.txt
  V1_NaKLCaT_chaotic_Q_dt0.1_T800.0_18aug14_NOISY.txt
  V1_NaKLCaT_chaotic_Q_dt0.1_T800.0_18aug14_NOISY.txt
and three resulting from the "active" (WLC) synapse strengths:
  V0_NaKLCaT_chaotic_WLC_dt0.1_T800.0_18aug14_NOISY.txt
  V1_NaKLCaT_chaotic_WLC_dt0.1_T800.0_18aug14_NOISY.txt
  V1_NaKLCaT_chaotic_WLC_dt0.1_T800.0_18aug14_NOISY.txt.
The filenames indicate that these come from an "NaKL-plus-CaT" neuron model, using a chaotic injected current, with a time step
of 0.1 ms, a total integration time of 800 ms, and that 1% noise was added to the resulting voltage trace prior to delivering the data
to the DA (Ipopt) procedure.  These data were not generated by the pruning experiments.  That is: the connectivity is all-to-all, and 
all neurons have leak, Na, K, and CaT ion channels.  THESE ARE THE DATA THAT WERE READ INTO THE DA PROCEDURE IN ORDER TO GENERATE 
THE MAIN RESULTS OF THE PAPER.

###
2) Write the user interface to work with the Interior-point Optimizer (Ipopt)

Our group developed a C-based user interface to do this, which can be found here:
https://github.com/yejingxin/minAone

###
3) Run Ipopt, and download the output. 

These will be .dat files, which are matrices of m rows and n columns.  

The number of rows m is 'beta': the number of iterative re-weightings of the measurement-versus-model error of the cost function A_0 
(see the description of "Annealing" in the main text of the paper).  An ideal value for beta is between 22 and 30; for all results 
presented in this paper, we found a value of 27 to yield the best estimates.

The number of columns is: [3 + t*D + p], where t is the number of timesteps in the data, D is the number of state variables, and p
is the number of parameters to be estimated.  The "3" at the start consists of the value of the cost function (A_0), and two flags
that are not important for our purposes.

###
4) Read the output .dat file from Ipopt ("Read-DA-Results...ipynb")

The information you want to extract is: the value of the cost function at each value of beta, and the values of the parameters at 
each value of beta.  

The script "Read-DA-Results...ipynb" plots the cost function versus beta, parameter values versus beta, and prints the precise
values of the parameters given a user-specified value of beta.
